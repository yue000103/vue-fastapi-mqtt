# æ¶²ç›¸è‰²è°±ä»ªç³»ç»Ÿæ¶æ„è®¾è®¡

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

åŸºäºç°æœ‰Vue + FastAPI + MQTTå®æ—¶é‡‡é›†ç³»ç»Ÿï¼Œé›†æˆ22ä¸ªç¡¬ä»¶è®¾å¤‡ï¼Œæ„å»ºå®Œæ•´çš„æ¶²ç›¸è‰²è°±ä»ªè‡ªåŠ¨åŒ–æ§åˆ¶ç³»ç»Ÿã€‚

### ç¡¬ä»¶è®¾å¤‡æ¸…å•

#### ä¸»æœºæ¨¡å— (é€šè¿‡æ ‘è“æ´¾ä¸²å£é€šä¿¡)
- **ç»§ç”µå™¨æ§åˆ¶**: åŒ2(ä½å‹ç”µç£é˜€)ã€åŒ1(é«˜å‹ç”µç£é˜€)ã€æ³µ2(æ°”æ³µ)
- **å‹åŠ›ä¼ æ„Ÿå™¨**: ttyAMA0æ¥å£ï¼Œæ³¢ç‰¹ç‡9600
- **æ£€æµ‹å™¨**: ttyAMA3æ¥å£ï¼Œæ³¢ç‰¹ç‡57600
- **å››åˆä¸€é«˜å‹æ’æµæ³µ**: ttyAMA2æ¥å£ï¼Œæ³¢ç‰¹ç‡115200
- **æ°”æ³¡ä¼ æ„Ÿå™¨**: æ°”1ã€æ°”2ã€æ°”3ã€æ°”4 (4ä¸ªä¼ æ„Ÿå™¨)

#### æ”¶é›†æ¨¡å— (é€šè¿‡IPåœ°å€HTTPé€šä¿¡)
- **LEDç¯æ§åˆ¶**: 192.168.1.129/led/on
- **å•ä¸ªé˜€é—¨æ§åˆ¶**: ç”µ1-ç”µ6ã€æ³µ3ã€åŒ3 (8ä¸ªè®¾å¤‡)
- **æ°”æ³¡ä¼ æ„Ÿå™¨çŠ¶æ€**: æ°”5ã€æ°”6ã€æ°”7 (3ä¸ªä¼ æ„Ÿå™¨)
- **å¤šå‘é˜€æ§åˆ¶**: å¤š1-å¤š11 (11ä¸ªå¤šå‘é˜€)
- **éš”è†œæ³µæ§åˆ¶**: æ³µ4

---

## ğŸ—ï¸ æ•´ä½“ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Vueå‰ç«¯ç•Œé¢    â”‚    â”‚  FastAPIæ ¸å¿ƒ    â”‚    â”‚   ç¡¬ä»¶æŠ½è±¡å±‚     â”‚
â”‚                â”‚    â”‚                â”‚    â”‚                â”‚
â”‚ â”œâ”€å®æ—¶æ•°æ®æ˜¾ç¤º   â”‚â—„â”€â”€â–ºâ”‚ â”œâ”€MQTTæœåŠ¡      â”‚â—„â”€â”€â–ºâ”‚ â”œâ”€ä¸»æœºæ¨¡å—é©±åŠ¨   â”‚
â”‚ â”œâ”€è®¾å¤‡æ§åˆ¶é¢æ¿   â”‚    â”‚ â”œâ”€RESTful API   â”‚    â”‚ â”œâ”€æ”¶é›†æ¨¡å—é©±åŠ¨   â”‚
â”‚ â”œâ”€æµç¨‹ç®¡ç†      â”‚    â”‚ â”œâ”€è®¾å¤‡ç®¡ç†å™¨     â”‚    â”‚ â”œâ”€åè®®è½¬æ¢å™¨     â”‚
â”‚ â””â”€çŠ¶æ€ç›‘æ§      â”‚    â”‚ â””â”€æ•°æ®å¤„ç†å™¨     â”‚    â”‚ â””â”€é”™è¯¯å¤„ç†å™¨     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚                        â”‚
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚   æ•°æ®å­˜å‚¨å±‚     â”‚    â”‚   ç‰©ç†ç¡¬ä»¶å±‚     â”‚
                       â”‚                â”‚    â”‚                â”‚
                       â”‚ â”œâ”€SQLiteæ•°æ®åº“   â”‚    â”‚ â”œâ”€æ ‘è“æ´¾ä¸²å£è®¾å¤‡  â”‚
                       â”‚ â”œâ”€æ–‡ä»¶å­˜å‚¨       â”‚    â”‚ â”œâ”€IPç½‘ç»œè®¾å¤‡     â”‚
                       â”‚ â”œâ”€æ—¥å¿—ç³»ç»Ÿ      â”‚    â”‚ â”œâ”€ä¼ æ„Ÿå™¨ç¾¤      â”‚
                       â”‚ â””â”€æ–‡ä»¶å­˜å‚¨      â”‚    â”‚ â””â”€æ‰§è¡Œå™¨ç¾¤      â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ è¯¦ç»†æ–‡ä»¶ç»“æ„è®¾è®¡

### å‰ç«¯æ¶æ„ (Vue 3)
```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ views/                          # é¡µé¢è§†å›¾
â”‚   â”‚   â”œâ”€â”€ Dashboard.vue               # ä¸»ä»ªè¡¨ç›˜
â”‚   â”‚   â”œâ”€â”€ DeviceControl.vue           # è®¾å¤‡æ§åˆ¶ç•Œé¢
â”‚   â”‚   â”œâ”€â”€ ChromatographyProcess.vue   # è‰²è°±ä»ªæµç¨‹æ§åˆ¶
â”‚   â”‚   â”œâ”€â”€ DataAnalysis.vue            # æ•°æ®åˆ†æç•Œé¢
â”‚   â”‚   â”œâ”€â”€ SystemConfig.vue            # ç³»ç»Ÿé…ç½®ç•Œé¢
â”‚   â”‚   â””â”€â”€ MaintenanceLog.vue          # ç»´æŠ¤æ—¥å¿—
â”‚   â”‚
â”‚   â”œâ”€â”€ components/                     # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ charts/                     # å›¾è¡¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ RealtimeChart.vue       # å®æ—¶æ•°æ®å›¾è¡¨
â”‚   â”‚   â”‚   â”œâ”€â”€ PressureChart.vue       # å‹åŠ›æ›²çº¿å›¾
â”‚   â”‚   â”‚   â””â”€â”€ DetectorChart.vue       # æ£€æµ‹å™¨ä¿¡å·å›¾
â”‚   â”‚   â”œâ”€â”€ device-panels/              # è®¾å¤‡æ§åˆ¶é¢æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ RelayPanel.vue          # ç»§ç”µå™¨æ§åˆ¶é¢æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ PumpPanel.vue           # æ³µæ§åˆ¶é¢æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ ValvePanel.vue          # é˜€é—¨æ§åˆ¶é¢æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ SensorPanel.vue         # ä¼ æ„Ÿå™¨çŠ¶æ€é¢æ¿
â”‚   â”‚   â”‚   â””â”€â”€ DetectorPanel.vue       # æ£€æµ‹å™¨æ§åˆ¶é¢æ¿
â”‚   â”‚   â”œâ”€â”€ monitoring/                 # ç›‘æ§ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ SystemStatus.vue        # ç³»ç»ŸçŠ¶æ€
â”‚   â”‚   â”‚   â”œâ”€â”€ AlarmPanel.vue          # å‘Šè­¦é¢æ¿
â”‚   â”‚   â”‚   â””â”€â”€ LogViewer.vue           # æ—¥å¿—æŸ¥çœ‹å™¨
â”‚   â”‚   â””â”€â”€ workflow/                   # å·¥ä½œæµç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ ProcessSteps.vue        # æµç¨‹æ­¥éª¤
â”‚   â”‚       â”œâ”€â”€ MethodEditor.vue        # æ–¹æ³•ç¼–è¾‘å™¨
â”‚   â”‚       â””â”€â”€ SampleQueue.vue         # æ ·å“é˜Ÿåˆ—
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                       # å‰ç«¯æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ device-api.js               # è®¾å¤‡APIæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ mqtt-service.js             # MQTTé€šä¿¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ data-service.js             # æ•°æ®å¤„ç†æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ workflow-service.js         # å·¥ä½œæµæœåŠ¡
â”‚   â”‚   â””â”€â”€ config-service.js           # é…ç½®ç®¡ç†æœåŠ¡
â”‚   â”‚
â”‚   â”œâ”€â”€ store/                          # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â”‚   â”œâ”€â”€ devices.js              # è®¾å¤‡çŠ¶æ€
â”‚   â”‚   â”‚   â”œâ”€â”€ workflow.js             # å·¥ä½œæµçŠ¶æ€
â”‚   â”‚   â”‚   â””â”€â”€ realtime-data.js        # å®æ—¶æ•°æ®
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”‚
â”‚   â””â”€â”€ utils/                          # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ device-utils.js             # è®¾å¤‡å·¥å…·
â”‚       â”œâ”€â”€ data-utils.js               # æ•°æ®å¤„ç†å·¥å…·
â”‚       â””â”€â”€ chart-utils.js              # å›¾è¡¨å·¥å…·
```

### åç«¯æ¶æ„ (FastAPI)
```
backend/
â”œâ”€â”€ api/                                # APIè·¯ç”±å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ device_control.py               # è®¾å¤‡æ§åˆ¶API
â”‚   â”œâ”€â”€ data_collection.py              # æ•°æ®é‡‡é›†API
â”‚   â”œâ”€â”€ system_management.py            # ç³»ç»Ÿç®¡ç†API
â”‚   â”œâ”€â”€ chromatography.py               # è‰²è°±ä»ªä¸“ç”¨API
â”‚   â”œâ”€â”€ workflow.py                     # å·¥ä½œæµAPI
â”‚   â””â”€â”€ maintenance.py                  # ç»´æŠ¤ç®¡ç†API
â”‚
â”œâ”€â”€ services/                           # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ device_manager.py               # è®¾å¤‡ç®¡ç†å™¨
â”‚   â”œâ”€â”€ data_processor.py               # æ•°æ®å¤„ç†å™¨
â”‚   â”œâ”€â”€ workflow_engine.py              # å·¥ä½œæµå¼•æ“
â”‚   â”œâ”€â”€ alert_manager.py                # å‘Šè­¦ç®¡ç†å™¨
â”‚   â”œâ”€â”€ method_manager.py               # æ–¹æ³•ç®¡ç†å™¨
â”‚   â””â”€â”€ calibration_service.py          # æ ¡å‡†æœåŠ¡
â”‚
â”œâ”€â”€ models/                             # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ device_models.py                # è®¾å¤‡æ¨¡å‹
â”‚   â”œâ”€â”€ data_models.py                  # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ config_models.py                # é…ç½®æ¨¡å‹
â”‚   â”œâ”€â”€ workflow_models.py              # å·¥ä½œæµæ¨¡å‹
â”‚   â””â”€â”€ result_models.py                # ç»“æœæ¨¡å‹
â”‚
â”œâ”€â”€ core/                               # æ ¸å¿ƒåŠŸèƒ½
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ mqtt_manager.py                 # MQTTç®¡ç†å™¨
â”‚   â”œâ”€â”€ task_scheduler.py               # ä»»åŠ¡è°ƒåº¦å™¨
â”‚   â”œâ”€â”€ exception_handler.py            # å¼‚å¸¸å¤„ç†å™¨
â”‚   â”œâ”€â”€ security.py                     # å®‰å…¨è®¤è¯
â”‚   â””â”€â”€ database.py                     # æ•°æ®åº“è¿æ¥
â”‚
â”œâ”€â”€ config/                             # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ settings.py                     # åº”ç”¨é…ç½®
â”‚   â”œâ”€â”€ device_config.py                # è®¾å¤‡é…ç½®
â”‚   â””â”€â”€ logging_config.py               # æ—¥å¿—é…ç½®
â”‚
â””â”€â”€ utils/                              # å·¥å…·å‡½æ•°
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ data_utils.py                   # æ•°æ®å¤„ç†å·¥å…·
    â”œâ”€â”€ device_utils.py                 # è®¾å¤‡å·¥å…·
    â””â”€â”€ validation.py                   # æ•°æ®éªŒè¯
```

### ç¡¬ä»¶æŠ½è±¡å±‚
```
hardware/
â”œâ”€â”€ host_devices/                       # ä¸»æœºæ¨¡å— (æ ‘è“æ´¾ä¸²å£)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ relay_controller.py             # ç»§ç”µå™¨æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ RelayControllerç±»: æ§åˆ¶åŒ2ã€åŒ1ã€æ³µ2
â”‚   â”œâ”€â”€ pressure_sensor.py              # å‹åŠ›ä¼ æ„Ÿå™¨
â”‚   â”‚   â””â”€â”€ PressureSensorç±»: ttyAMA0, 9600æ³¢ç‰¹ç‡
â”‚   â”œâ”€â”€ detector.py                     # æ£€æµ‹å™¨
â”‚   â”‚   â””â”€â”€ DetectorControllerç±»: ttyAMA3, 57600æ³¢ç‰¹ç‡
â”‚   â”œâ”€â”€ pump_controller.py              # é«˜å‹æ’æµæ³µ
â”‚   â”‚   â””â”€â”€ PumpControllerç±»: ttyAMA2, 115200æ³¢ç‰¹ç‡
â”‚   â””â”€â”€ bubble_sensor.py                # æ°”æ³¡ä¼ æ„Ÿå™¨
â”‚       â””â”€â”€ BubbleSensorHostç±»: æ°”1-æ°”4ä¼ æ„Ÿå™¨
â”‚
â”œâ”€â”€ collect_devices/                    # æ”¶é›†æ¨¡å— (IPç½‘ç»œ)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ led_controller.py               # LEDç¯æ§åˆ¶
â”‚   â”‚   â””â”€â”€ LEDControllerç±»: 192.168.1.129/led/on
â”‚   â”œâ”€â”€ valve_controller.py             # é˜€é—¨æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ ValveControllerç±»: ç”µ1-ç”µ6ã€æ³µ3ã€åŒ3æ§åˆ¶
â”‚   â”œâ”€â”€ bubble_sensor_collect.py        # æ°”æ³¡ä¼ æ„Ÿå™¨çŠ¶æ€
â”‚   â”‚   â””â”€â”€ BubbleSensorCollectç±»: æ°”5-æ°”7çŠ¶æ€è¯»å–
â”‚   â”œâ”€â”€ multi_valve.py                  # å¤šå‘é˜€æ§åˆ¶
â”‚   â”‚   â””â”€â”€ MultiValveControllerç±»: å¤š1-å¤š11æ§åˆ¶
â”‚   â””â”€â”€ pump_spray.py                   # éš”è†œæ³µæ§åˆ¶
â”‚       â””â”€â”€ SprayPumpControllerç±»: æ³µ4æ§åˆ¶
â”‚
â”œâ”€â”€ drivers/                            # åº•å±‚é©±åŠ¨
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ serial_driver.py                # ä¸²å£é©±åŠ¨
â”‚   â”‚   â”œâ”€â”€ SerialPortç±»: ä¸²å£è¿æ¥ç®¡ç†
â”‚   â”‚   â””â”€â”€ SerialProtocolç±»: ä¸²å£åè®®å°è£…
â”‚   â”œâ”€â”€ http_driver.py                  # HTTPé€šä¿¡é©±åŠ¨
â”‚   â”‚   â”œâ”€â”€ HTTPClientç±»: HTTPè¯·æ±‚å°è£…
â”‚   â”‚   â””â”€â”€ NetworkManagerç±»: ç½‘ç»œè¿æ¥ç®¡ç†
â”‚   â””â”€â”€ protocol_converter.py           # åè®®è½¬æ¢å™¨
â”‚       â”œâ”€â”€ DataConverterç±»: æ•°æ®æ ¼å¼è½¬æ¢
â”‚       â””â”€â”€ CommandTranslatorç±»: å‘½ä»¤ç¿»è¯‘
â”‚
â”œâ”€â”€ interfaces/                         # ç¡¬ä»¶æ¥å£
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ device_interface.py             # è®¾å¤‡é€šç”¨æ¥å£
â”‚   â”‚   â””â”€â”€ DeviceInterfaceæŠ½è±¡ç±»
â”‚   â”œâ”€â”€ sensor_interface.py             # ä¼ æ„Ÿå™¨æ¥å£
â”‚   â”‚   â””â”€â”€ SensorInterfaceæŠ½è±¡ç±»
â”‚   â””â”€â”€ actuator_interface.py           # æ‰§è¡Œå™¨æ¥å£
â”‚       â””â”€â”€ ActuatorInterfaceæŠ½è±¡ç±»
â”‚
â””â”€â”€ tests/                              # ç¡¬ä»¶æµ‹è¯•
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ test_host_devices.py            # ä¸»æœºè®¾å¤‡æµ‹è¯•
    â”œâ”€â”€ test_collect_devices.py         # æ”¶é›†è®¾å¤‡æµ‹è¯•
    â””â”€â”€ test_integration.py             # é›†æˆæµ‹è¯•
```

### æ•°æ®ç®¡ç†å±‚
```
data/
â”œâ”€â”€ database/                           # SQLiteæ•°æ®åº“
â”‚   â”œâ”€â”€ migrations/                     # æ•°æ®åº“è¿ç§»è„šæœ¬
â”‚   â”œâ”€â”€ chromatography.db               # ä¸»æ•°æ®åº“æ–‡ä»¶
â”‚   â”œâ”€â”€ schemas/                        # æ•°æ®åº“è¡¨ç»“æ„
â”‚   â”‚   â”œâ”€â”€ device_config.sql           # è®¾å¤‡é…ç½®è¡¨
â”‚   â”‚   â”œâ”€â”€ sensor_data.sql             # ä¼ æ„Ÿå™¨æ•°æ®è¡¨
â”‚   â”‚   â”œâ”€â”€ process_data.sql            # è¿‡ç¨‹æ•°æ®è¡¨
â”‚   â”‚   â”œâ”€â”€ method_storage.sql          # æ–¹æ³•å­˜å‚¨è¡¨
â”‚   â”‚   â”œâ”€â”€ user_management.sql         # ç”¨æˆ·ç®¡ç†è¡¨
â”‚   â”‚   â””â”€â”€ audit_logs.sql              # å®¡è®¡æ—¥å¿—è¡¨
â”‚   â””â”€â”€ backup/                         # æ•°æ®åº“å¤‡ä»½
â”‚       â”œâ”€â”€ daily/                      # æ—¥å¤‡ä»½
â”‚       â””â”€â”€ weekly/                     # å‘¨å¤‡ä»½
â”‚
â”œâ”€â”€ storage/                            # æ–‡ä»¶å­˜å‚¨
â”‚   â”œâ”€â”€ logs/                           # æ—¥å¿—æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ application/                # åº”ç”¨æ—¥å¿—
â”‚   â”‚   â”œâ”€â”€ device/                     # è®¾å¤‡æ—¥å¿—
â”‚   â”‚   â””â”€â”€ audit/                      # å®¡è®¡æ—¥å¿—
â”‚   â”œâ”€â”€ configs/                        # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ device_configs/             # è®¾å¤‡é…ç½®
â”‚   â”‚   â”œâ”€â”€ method_configs/             # æ–¹æ³•é…ç½®
â”‚   â”‚   â””â”€â”€ system_configs/             # ç³»ç»Ÿé…ç½®
â”‚   â”œâ”€â”€ exports/                        # å¯¼å‡ºæ•°æ®
â”‚   â”‚   â”œâ”€â”€ reports/                    # æŠ¥å‘Šæ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ data_exports/               # æ•°æ®å¯¼å‡º
â”‚   â”‚   â””â”€â”€ charts/                     # å›¾è¡¨å¯¼å‡º
â”‚   â””â”€â”€ uploads/                        # ä¸Šä¼ æ–‡ä»¶
â”‚       â”œâ”€â”€ methods/                    # æ–¹æ³•æ–‡ä»¶
â”‚       â””â”€â”€ calibrations/               # æ ¡å‡†æ–‡ä»¶
â”‚
â””â”€â”€ backup/                             # æ•°æ®å¤‡ä»½
    â”œâ”€â”€ daily/                          # æ—¥å¤‡ä»½
    â”œâ”€â”€ weekly/                         # å‘¨å¤‡ä»½
    â””â”€â”€ monthly/                        # æœˆå¤‡ä»½
```

---

## ğŸ”§ æ ¸å¿ƒæ¨¡å—è®¾è®¡

### 1. è®¾å¤‡ç®¡ç†å™¨ (DeviceManager)
```python
class DeviceManager:
    """ç»Ÿä¸€è®¾å¤‡ç®¡ç†å™¨"""
    def __init__(self):
        self.host_devices = {}          # ä¸»æœºæ¨¡å—è®¾å¤‡ (ä¸²å£)
        self.collect_devices = {}       # æ”¶é›†æ¨¡å—è®¾å¤‡ (HTTP)
        self.device_status = {}         # è®¾å¤‡çŠ¶æ€ç¼“å­˜
        self.communication_manager = CommunicationManager()

    async def initialize_devices(self):
        """åˆå§‹åŒ–æ‰€æœ‰22ä¸ªè®¾å¤‡"""
        # åˆå§‹åŒ–ä¸»æœºæ¨¡å—è®¾å¤‡ (5ç±»)
        # åˆå§‹åŒ–æ”¶é›†æ¨¡å—è®¾å¤‡ (17ä¸ª)

    async def control_device(self, device_id: str, action: str, params: dict):
        """ç»Ÿä¸€è®¾å¤‡æ§åˆ¶æ¥å£"""

    async def get_device_data(self, device_id: str):
        """è·å–è®¾å¤‡å®æ—¶æ•°æ®"""

    async def monitor_devices(self):
        """æŒç»­ç›‘æ§æ‰€æœ‰è®¾å¤‡çŠ¶æ€"""

    async def calibrate_device(self, device_id: str, calibration_params: dict):
        """è®¾å¤‡æ ¡å‡†åŠŸèƒ½"""
```

### 2. æ¶²ç›¸è‰²è°±ä»ªå·¥ä½œæµå¼•æ“
```python
class ChromatographyWorkflow:
    """æ¶²ç›¸è‰²è°±ä»ªä¸“ç”¨å·¥ä½œæµå¼•æ“"""
    def __init__(self):
        self.workflow_steps = []
        self.current_step = 0
        self.device_manager = DeviceManager()

    async def run_sample_injection(self, sample_params: dict):
        """æ ·å“æ³¨å…¥æµç¨‹"""
        # 1. æ£€æŸ¥ç³»ç»Ÿå‹åŠ›
        # 2. åˆ‡æ¢è¿›æ ·é˜€åˆ°LOADä½ç½®
        # 3. å¯åŠ¨è¿›æ ·æ³µ
        # 4. åˆ‡æ¢è¿›æ ·é˜€åˆ°INJECTä½ç½®

    async def run_separation_process(self, method_params: dict):
        """åˆ†ç¦»è¿‡ç¨‹æ§åˆ¶"""
        # 1. è®¾ç½®æµåŠ¨ç›¸ç»„æˆ
        # 2. è°ƒèŠ‚æµé€Ÿå’Œå‹åŠ›
        # 3. æ§åˆ¶æŸ±æ¸©
        # 4. ç›‘æ§åˆ†ç¦»æ•ˆæœ

    async def run_detection_cycle(self):
        """æ£€æµ‹å‘¨æœŸç®¡ç†"""
        # 1. é…ç½®æ£€æµ‹å™¨å‚æ•°
        # 2. å¼€å§‹æ•°æ®é‡‡é›†
        # 3. å®æ—¶ç›‘æ§ä¿¡å·
        # 4. æ•°æ®å¤„ç†å’Œå­˜å‚¨

    async def run_cleaning_procedure(self):
        """æ¸…æ´—ç¨‹åº"""
        # 1. åˆ‡æ¢æ¸…æ´—æº¶å‰‚
        # 2. é«˜æµé€Ÿå†²æ´—ç®¡è·¯
        # 3. æ¸…æ´—è¿›æ ·å™¨
        # 4. ç³»ç»Ÿé¢„å¹³è¡¡
```

### 3. å¤šåè®®é€šä¿¡ç®¡ç†
```python
class CommunicationManager:
    """å¤šåè®®é€šä¿¡ç®¡ç†å™¨"""
    def __init__(self):
        self.serial_connections = {}    # ä¸²å£è¿æ¥æ± 
        self.http_sessions = {}         # HTTPä¼šè¯æ± 

    async def send_serial_command(self, port: str, command: bytes, baudrate: int):
        """ä¸²å£å‘½ä»¤å‘é€"""
        # æ”¯æŒttyAMA0(9600), ttyAMA2(115200), ttyAMA3(57600)

    async def send_http_request(self, url: str, data: dict, method: str = "GET"):
        """HTTPè¯·æ±‚å‘é€"""
        # æ”¯æŒ192.168.1.129çš„å„ç§æ¥å£

    async def read_sensor_data(self, device_type: str, device_id: str):
        """ä¼ æ„Ÿå™¨æ•°æ®è¯»å–"""

    async def control_actuator(self, device_type: str, device_id: str, action: dict):
        """æ‰§è¡Œå™¨æ§åˆ¶"""
```

### 4. å®æ—¶æ•°æ®æµå¤„ç†
```python
class DataStreamProcessor:
    """å®æ—¶æ•°æ®æµå¤„ç†å™¨"""
    def __init__(self):
        self.mqtt_publisher = MQTTPublisher()
        self.data_buffer = {}
        self.processors = {
            'pressure': self.process_pressure_data,
            'detector': self.process_detector_data,
            'bubble': self.process_bubble_data,
        }

    async def process_sensor_data(self, device_id: str, raw_data: bytes):
        """ä¼ æ„Ÿå™¨æ•°æ®å¤„ç†"""

    async def process_pressure_data(self, raw_data: bytes):
        """å‹åŠ›ä¼ æ„Ÿå™¨æ•°æ®å¤„ç†"""

    async def process_detector_data(self, raw_data: bytes):
        """æ£€æµ‹å™¨ä¿¡å·å¤„ç†"""

    async def process_bubble_data(self, raw_data: str):
        """æ°”æ³¡ä¼ æ„Ÿå™¨æ•°æ®å¤„ç†"""

    async def publish_realtime_data(self, processed_data: dict):
        """å‘å¸ƒå®æ—¶æ•°æ®åˆ°MQTT"""
        topics = {
            'pressure': 'chromatography/pressure',
            'detector': 'chromatography/detector',
            'bubble': 'chromatography/bubble',
            'flow': 'chromatography/flow',
        }
```

---

## ğŸ“Š æ•°æ®æµç¨‹è®¾è®¡

### å®æ—¶æ•°æ®æµ
```
[ä¼ æ„Ÿå™¨] â†’ [ç¡¬ä»¶é©±åŠ¨] â†’ [æ•°æ®å¤„ç†å™¨] â†’ [MQTTå‘å¸ƒ] â†’ [å‰ç«¯æ˜¾ç¤º]
    â†“           â†“            â†“
[è®¾å¤‡æ—¥å¿—] â†’ [SQLiteæ•°æ®åº“] â†’ [æ•°æ®åˆ†æ]
```

### æ§åˆ¶æŒ‡ä»¤æµ
```
[å‰ç«¯ç•Œé¢] â†’ [APIæ¥å£] â†’ [è®¾å¤‡ç®¡ç†å™¨] â†’ [ç¡¬ä»¶é©±åŠ¨] â†’ [ç‰©ç†è®¾å¤‡]
    â†“           â†“           â†“
[æ“ä½œæ—¥å¿—] â†’ [å®¡è®¡è®°å½•] â†’ [çŠ¶æ€åé¦ˆ]
```

---

## ğŸš€ å…³é”®ç‰¹æ€§

### 1. è®¾å¤‡æŠ½è±¡åŒ–
- 22ä¸ªç¡¬ä»¶è®¾å¤‡ç»Ÿä¸€æ¥å£
- ä¸²å£å’ŒHTTPåŒåè®®æ”¯æŒ
- è‡ªåŠ¨è®¾å¤‡å‘ç°å’ŒçŠ¶æ€ç›‘æ§

### 2. å®æ—¶æ€§ä¿è¯
- åŸºäºMQTTçš„å®æ—¶æ•°æ®ä¼ è¾“
- å¾®ç§’çº§ä¼ æ„Ÿå™¨æ•°æ®é‡‡é›†
- å®æ—¶å›¾è¡¨å’ŒçŠ¶æ€æ›´æ–°

### 3. å·¥ä½œæµè‡ªåŠ¨åŒ–
- å¯é…ç½®çš„è‰²è°±åˆ†ææµç¨‹
- è‡ªåŠ¨æ ·å“å¤„ç†é˜Ÿåˆ—
- æ™ºèƒ½é”™è¯¯æ¢å¤æœºåˆ¶

### 4. æ•°æ®å®Œæ•´æ€§
- SQLiteæ•°æ®åº“å­˜å‚¨
- å®Œæ•´çš„æ“ä½œå®¡è®¡æ—¥å¿—
- æ•°æ®å¤‡ä»½å’Œæ¢å¤

### 5. æ‰©å±•æ€§è®¾è®¡
- æ¨¡å—åŒ–ç¡¬ä»¶é©±åŠ¨
- æ’ä»¶åŒ–å·¥ä½œæµæ­¥éª¤
- RESTful APIæ¥å£

---

## ğŸ” æŠ€æœ¯æ ˆé€‰å‹

### å‰ç«¯æŠ€æœ¯æ ˆ
- **Vue 3** + Composition API
- **Chart.js** / **ECharts** - å®æ—¶æ•°æ®å¯è§†åŒ–
- **Element Plus** - UIç»„ä»¶åº“
- **Pinia** - çŠ¶æ€ç®¡ç†
- **MQTT.js** - MQTTå®¢æˆ·ç«¯

### åç«¯æŠ€æœ¯æ ˆ
- **FastAPI** - é«˜æ€§èƒ½APIæ¡†æ¶
- **Pydantic** - æ•°æ®éªŒè¯å’Œåºåˆ—åŒ–
- **SQLAlchemy** - ORMæ¡†æ¶
- **Celery** - å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—
- **paho-mqtt** - MQTTå®¢æˆ·ç«¯
- **pyserial** - ä¸²å£é€šä¿¡

### æ•°æ®å­˜å‚¨
- **SQLite** - è½»é‡çº§å…³ç³»æ•°æ®åº“ï¼Œæ–‡ä»¶å­˜å‚¨ï¼Œé›¶é…ç½®
- **JSONæ–‡ä»¶** - é…ç½®å’Œç¼“å­˜æ•°æ®å­˜å‚¨
- **CSV/TXT** - æ•°æ®å¯¼å‡ºå’Œæ—¥å¿—æ–‡ä»¶

### é€šä¿¡åè®®
- **MQTT** - å®æ—¶æ¶ˆæ¯ä¼ è¾“
- **HTTP/WebSocket** - APIé€šä¿¡
- **Serial/RS485** - ç¡¬ä»¶è®¾å¤‡é€šä¿¡

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### å®æ—¶æ€§è¦æ±‚
- ä¼ æ„Ÿå™¨æ•°æ®é‡‡é›†é¢‘ç‡: â‰¤100ms
- MQTTæ¶ˆæ¯å»¶è¿Ÿ: â‰¤50ms
- å‰ç«¯å›¾è¡¨æ›´æ–°é¢‘ç‡: â‰¤200ms
- è®¾å¤‡æ§åˆ¶å“åº”æ—¶é—´: â‰¤500ms

### å¯é æ€§è¦æ±‚
- ç³»ç»Ÿå¯ç”¨æ€§: â‰¥99.5%
- æ•°æ®å®Œæ•´æ€§: 100%
- è‡ªåŠ¨æ•…éšœæ¢å¤: â‰¤30s
- è®¾å¤‡é€šä¿¡æˆåŠŸç‡: â‰¥99%

### æ‰©å±•æ€§è¦æ±‚
- æ”¯æŒè®¾å¤‡æ•°é‡: 100+ä¸ª
- å¹¶å‘ç”¨æˆ·æ•°: 10+ä¸ª
- æ•°æ®å­˜å‚¨å‘¨æœŸ: 1å¹´+
- APIå“åº”èƒ½åŠ›: 1000+è¯·æ±‚/åˆ†é’Ÿ

---

æ­¤æ¶æ„è®¾è®¡å……åˆ†åˆ©ç”¨äº†ç°æœ‰çš„Vue+FastAPI+MQTTåŸºç¡€è®¾æ–½ï¼Œé€šè¿‡åˆ†å±‚è®¾è®¡å’Œæ¨¡å—åŒ–å¼€å‘ï¼Œå¯ä»¥é«˜æ•ˆåœ°é›†æˆ22ä¸ªç¡¬ä»¶è®¾å¤‡ï¼Œæ„å»ºå®Œæ•´çš„æ¶²ç›¸è‰²è°±ä»ªè‡ªåŠ¨åŒ–æ§åˆ¶ç³»ç»Ÿã€‚